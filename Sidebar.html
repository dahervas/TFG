<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <!--<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">-->
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <!--<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">-->
    <!-- The CSS package above applies Google styling to buttons and other elements. -->
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.js"></script>
    
    <style>
    
    div.success {
      padding-top: 10px;
      color: green;
    }
    
    select.select_style{
      padding-top: 10px;
    }
    
    div.error {
      padding-top: 10px;
    }
     
    #select_file {
      text-align: left;
      width: 95%;
      font-size: 1em;
      margin: auto;
      height: 3em;
    }
    
     #ficheros {
      text-align: left;
      width: 95%;
      font-size: 1em;
      margin: auto;
      height: 3em;
    }
    
    #select_files {
      text-align: left;
      font-size: 1em;
      margin: auto;
      width: 100%;
      height: 20em;
    }
    
    #select_file2 {
      text-align: left;
      width: 95%;
      font-size: 1em;
      margin: auto;
      height: 3em;
    }
  
    .branding-below {
      bottom: 56px;
      top: 0;
    }

    .branding-text {
      left: 7px;
      position: relative;
      top: 3px;
    }

    .col-contain {
      overflow: hidden;
    }

    .col-one {
      float: left;
      width: 50%;
    }

    .logo {
      vertical-align: middle;
    }

    .radio-spacer {
      height: 20px;
    }

    .width-100 {
      width: 100%;
    }
    /**********************************/
    /*
    .scrolling-wrapper {
      overflow-x: scroll;
      overflow-y: hidden;
      white-space: nowrap;
    }
    
    .scrolling-wrapper-flexbox {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      position: relative;
      top: 300px;
    }
    
    .card {
       width: 100px;
       height: 100px;
       background-color: red;
       float: left;
       margin: 5px;
    }*/
    
    .infoBlock {
      position: relative;
      top: 300px;
      text-align:center;
    }
    
    input[type="equis"] {
      -webkit-appearance: none;
      background: #fff;
      border: 1px solid #c6c6c6;
      border-image: -ms-linear-gradient(top, #fff, #fff);
      -webkit-border-radius: 50%;
      border-radius: 50%;
      -webkit-box-sizing: border-box;
      box-sizing: border-box;
      height: 15px;
      outline: 0;
      top: 2px;
      width: 15px;
    }

    input[type="equis"]:hover {
      -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .1);
      box-shadow: inset 0 1px 1px rgba(0, 0, 0, .1);
    }
    
    input[type="equis"]:active {
      background: #ebebeb;
      border: 1px solid #c6c6c6;
    }
    
    input[type="equis"]:focus {
      border: 1px solid #4d90fe;
    }
    
    input[type="equis"]:checked {
      background: #fff;
    }
    
    input[type="equis"]:checked:after {
      background: #606060;
      -webkit-border-radius: 50%;
      border-radius: 50%;
      content: '';
      display: block;
      height: 7px;
      left: 3px;
      position: relative;
      top: 3px;
      width: 7px;
    }
    
    input[type="equis"]:disabled {
      background-color: #fff;
      border: 1px solid #e1e1e1;
      -webkit-box-shadow: none;
      box-shadow: none;
      opacity: .5;
    }
    
    input:disabled + label {
      color: #afafaf;
    }
    
    .tooltip {
        position: relative;
        display: inline-block;
        border-bottom: 1px dotted black;
    }
    
    .tooltip .tooltiptext {
        visibility: hidden;
        width: 120px;
        background-color: #555;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 5px 0;
        position: absolute;
        z-index: 1;
        bottom: 125%;
        left: 50%;
        margin-left: -60px;
        opacity: 0;
        transition: opacity 0.3s;
    }
    
    .tooltip .tooltiptext::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #555 transparent transparent transparent;
    }
    
    .tooltip:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
    }
    
/*}*/
    /************************************/
/*}*/
    </style>
  </head>
  <body>
  
    <div class="sidebar branding-below">
      
       
      
      
        
      <form>
      
        <ul>
         
        </ul>
      
      
        <select onchange="selectFile(this);" id="select_file" >
         <!--<option id="select_file"></option>Con el id me muestra todo to que hay en el Drive-->
         
        </select>
        <label for="select_file">Selecciona los documentos bibtex:</label>
        <br>
        <!--<div class="block form-group">
          <label for="select_file">Selecciona el documento bibtex:</label><!-- Texto de información -->
          <!--<br>
          <select id="select_file" name="select_file"></select><!--Por el id, funciona-->
          <!--<p><b id="tittle" ></b></p>
          <p id="id"></p>
        </div>-->
        
        <!--<select multiple>
          <option>opt 1 text
          <option value="opt 2 value">opt 2 text
        </select>-->
        
        <!--<div class="block form-group">
          <label for="select_file">Selecciona otro documento bibtex:</label>
          <br>
          <select id="select_file2" name="select_file2"></select>
          <p><b id="tittle" ></b></p>
          <p id="id"></p>
        </div>-->
        <br>
        <div class="block form-group">
          <select id="select_style" name="select_style">
            <option value="unsrt">unsrt</option>
          </select>
          <br>
          <label for="select_style">Selecciona el estilo para la Bibliografía:</label>
        </div>
        
        <!-- <div class="block form-group">
          <label for="text"><b>Prueba:</b></label>
          <textarea class="width-100" id="text" name="text" rows="15"></textarea>
        </div> -->
        
        <div class="block" id="button-bar">
          
          <button class="green" id="reporte">Crear un reporte</button>
          <button class="blue" id="combinar">Combinar documentos</button>
          <!--<input type="reset" id="info" value="Informacion">-->
        </div>
        
         <br>
      <div class="block" id="button-bar">
        <!--<button class="blue" id="info">Información</button>-->
        <input type="reset" id="reset" value="Resetear formulario">
        <input type="reset" id="info" value="Informacion" onclick="showAlert()">
      </div>
        
        <div class="block form-group">
          <label for="select_style">Escribe datos de filtrado</label>
          <br>
          <form>
            <input type="text" placeholder="Tipo" id="filtroTipo">
            <div class="tooltip">Ayuda
              <span class="tooltiptext">article, book, techreport, misc ...</span>
            </div>
            <input type="text" placeholder="Año" id="filtroYear">
            <div class="tooltip">Ayuda
              <span class="tooltiptext">2000, 1990-1995 ...</span>
            </div>
            <input type="text" placeholder="Autor(es)" id="filtroAuthor">
            <div class="tooltip">Ayuda
              <span class="tooltiptext">David, Tip AND Frank, Boye OR David ...</span>
            </div>
            <input type="text" placeholder="Serie(s)" id="filtroSeries">
            <div class="tooltip">Ayuda
              <span class="tooltiptext">LNCS, OSDI'08 ...</span>
            </div>
            <input type="text" placeholder="Editorial(es)" id="filtroEditoriales">
            <div class="tooltip">Ayuda
              <span class="tooltiptext">John Wiley & Sons, Springer-Verlag ...</span>
            </div>
          </form>
          <!--<input type="text" placeholder="Tipo" id="filtro">-->
        </div>
        
        
       
        
      </form>
      
      <!--<br>
      <div class="block" id="button-bar">
        <!--<button class="blue" id="info">Información</button>-->
        <!--<input type="reset" id="reset" value="Resetear formulario">
        <input type="reset" id="info" value="Informacion" onclick="showAlert()">
      </div>-->
        
    
    </div>

    <div class="sidebar bottom">
      <img alt="Add-on logo" class="logo" src="https://www.gstatic.com/images/branding/product/1x/translate_48dp.png" width="27" height="27">
      <span class="gray branding-text">BETA v2.3</span>
    </div>
    
    <!--<div class="block">
      <div class="scrolling-wrapper-flexbox">
        <div class="card"><h2>Card</h2></div>
        <div class="card"><h2>Card</h2></div>
        <div class="card"><h2>Card</h2></div>
        <div class="card"><h2>Card</h2></div>
        <div class="card"><h2>Card</h2></div>
        <div class="card"><h2>Card</h2></div>
        <div class="card"><h2>Card</h2></div>
        <div class="card"><h2>Card</h2></div>
        <div class="card"><h2>Card</h2></div>
      </div>
     </div>-->
    
    <!--<div class="infoBlock">
      <select id="selectMe">
        <option disabled selected value="option1">Selecciona una clase para saber más información</option>
        <!--<option selected="default"></option>-->
        <!--<option value="option2">@book</option>
        <option value="option3">@article</option>
        <option value="option4">@techreport</option>
        <option value="option5">@misc</option>
      </select>
      
      <div id="option1" class="group"> </div>
      <div id="option2" class="group">Para libros y otros documentos más largos que deben incluir capítulos, prólogo, apéndices o incluso partes.</div>
      <div id="option3" class="group">Para artículos académicos y otros documentos cortos que no es necesario dividir en capítulos, sino que bastan las secciones y subsecciones y sus párrafos y subpárrafos.</div>
      <div id="option4" class="group">Se utiliza para elaborar informes técnicos. Es similar a la clase @book</div>
      <div id="option5" class="group">Cuando las demás clases no se corresponden se utiliza esta, no tiene atributos obligatorios</div>
      
     </div>-->
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
    </script>
    
    <script>
      var alldata = {};
      //var alldata2 = {};
      
      /*function selectFile(select){
        var $ul = $(select).prev('ul');
      
        if($ul.find('input[value=' + $(select).val() + ']').length == 0)
          $ul.append('<li onclick="$(this).remove();">' + '<input type="hidden" name="files[]" value="' + $(select).val() + '" /> ' 
          + $(select).find('option[selected]').val() + '</li>');
      
      }*/
      
      function selectFile(select){
        var $ul = $(select).prev('ul');
        //var disp = $('#select_file option:selected').text();
        var disp = document.getElementById('select_file');
        var text = disp.options[disp.selectedIndex].text;//FUNCIONA
        //var text = getSelectedText('select_file');
        //var file = DriveApp.getFileById(disp);
        //var name = file.getName();
        //alert(disp);
        //alert(text);
        //alert(name);
        if(text.indexOf("Folder") > -1|| text.indexOf("../") > -1){return;}
        else{
        
        
          if ($ul.find('input[value=' + $(select).val() + ']').length == 0)
            $ul.append('<li onclick="$(this).remove();">' +
              '<input type="hidden" name="select_file[]" value="' + 
              $(select).val() + '" /> ' +
              /*$(select).val()*/text + '<input type="equis">'/*'<button class="quitar" onclick="$(this).remove();">X</button>'*/ +'</li>');
        }
      }
      
      /**
       * On document load, assign click handlers to each button and try to load the
       * user's origin and destination language preferences if previously set.
       */
      
      $(function(){
        /*
          var docsBib = [];
        
        var files = document.getElementsByName("select_file[]"), i;
        for(i=0; i<files.length; i++){
          docsBib[i] = files[i].value;
        }
        */
     
        
          $('#info').click(showAlert);
        
        
      });
      
      
      
      function showAlert(){
        /*var uiInstance = UiApp.createApplication()
        .setWidth(250)
        .setHeight(300);
        uiInstance.add(uiInstance.createLabel('The photograph on the dashboard taken years ago...'));
        DocumentApp.getUi().showModelessDialog(uiInstance, 'My add-on');*/
        
        /*google.script.run
        .withUserObject(this)
        .showInfo();*/
        var docsBib1 = [];
        var files1 = document.getElementsByName("select_file[]"), i;
        for(i=0; i<files1.length; i++){
          docsBib1[i] = files1[i].value;
        }
        
        //if(docsBib1[0] == null){
          google.script.run
          .withUserObject(this)
          .showInfo();
          //.pruebaEscritura();
        /*}else{
          google.script.run
          .withUserObject(this)
          .showInfo2(docsBib1[0]);
        }*/
        
        //DocumentApp.getUi().createMenu('Información').addItem('Show information', 'showInfo').addToUi();
        
        //return ;
      }
      
      function showAlert2(aux){
        /*var uiInstance = UiApp.createApplication()
        .setWidth(250)
        .setHeight(300);
        uiInstance.add(uiInstance.createLabel('The photograph on the dashboard taken years ago...'));
        DocumentApp.getUi().showModelessDialog(uiInstance, 'My add-on');*/
        
        /*google.script.run
        .withUserObject(this)
        .showInfo();*/
        google.script.run
        .withUserObject(this)
        .showInfo(aux);
        
        //DocumentApp.getUi().createMenu('Información').addItem('Show information', 'showInfo').addToUi();
        
        //return ;
      }
      
      
      
      /*function selectIngredient(select){
        var $ul = $(select).prev('ul');
         
        if ($ul.find('input[value=' + $(select).val() + ']').length == 0)
          $ul.append('<li onclick="$(this).remove();">' +
            '<input type="hidden" name="ingredients[]" value="' + 
            $(select).val() + '" /> ' +
            $(select).find('option[selected]').text() + '</li>');
      }*/
      
      $(function() {
        $('#combinar').click(openDoc);
      });
      
       $(function() {
        $('#reporte').click(openDocReport);
      });
      
      
      $(function() {
        $('#reset').click(resetValues);
        
        /*var htmlOutput = HtmlService
        .createHtmlOutput('<p>A change of speed, a change of style...</p>')
        .setWidth(250)
        .setHeight(300);
        document.getUi().showModalDialog(htmlOutput, 'My add-on');*/
        
      });
      
      /*$(function() {
        $('#informacion').click(resetValues);
      });*/
      
      
      $(function() {
        google.script.run.withSuccessHandler(importData).getFiles("root");

        $('#select_file').change(function() {
           var id = $('#select_file').val();
           var disp = $('#select_file option:selected').text();
           if (~disp.indexOf("Folder") || ~disp.indexOf("../")) {
             $('#select_file > option').remove();
             if (alldata[id]) {
               var dat = {};
               dat[id] = alldata[id];
               importData(dat);
               return;
             } else {
               google.script.run.withSuccessHandler(importData).getFiles(id);
            
               return;
             }
             return;
           }
        });
        
        
        google.script.run.withSuccessHandler(importData2).getFiles("root");
        $('#select_file2').change(function() {
           var id2 = $('#select_file2').val();
           var disp2 = $('#select_file2 option:selected').text();
           if (~disp2.indexOf("Folder") || ~disp2.indexOf("../")) {
             $('#select_file2 > option').remove();
             if (alldata[id2]) {
               var datos = {};
               datos[id2] = alldata[id2];
               importData2(datos);
               return;
             } else {
               google.script.run.withSuccessHandler(importData2).getFiles(id2);
            
               return;
             }
             return;
           }
        });
        
      });

      function importData(e) {
        var key = Object.keys(e)[0];
        if (!alldata[key]) alldata[key] = e[key];
        if (e[key]["keyparent"]) {
          $('#select_file').append($('<option>').html("./" + e[key]["keyname"]).val(key));
          $('#select_file').append($('<option>').html("../").val(e[key]["keyparent"]));
          
          //$('#select_file2').append($('<option>').html("./" + e[key]["keyname"]).val(key));
          //$('#select_file2').append($('<option>').html("../").val(e[key]["keyparent"]));
        } else {
          //if(e[key]["files"].name.indexOf(".bib")){
          $('#select_file').append($('<option>').html("./" + e[key]["keyname"]).val(key));//}
          //$('#select_file2').append($('<option>').html("./" + e[key]["keyname"]).val(key));
        }
        for (var i=0; i < e[key]["files"].length; i++) {
          //var datos =getText(e[key]["files"][i].name);
          //if(datos.indexOf(".bib")){
            $('#select_file').append($('<option>')
              .html(e[key]["files"][i].mimeType == "folder" ? "[Folder]" + e[key]["files"][i].name : e[key]["files"][i].name)
              .val(e[key]["files"][i].id)
          //}
         /* $('#select_file').append($('<option>')
            .html(e[key]["files"][i].mimeType == "folder" ? "[Folder]" + e[key]["files"][i].name : e[key]["files"][i].name)
            .val(e[key]["files"][i].id)*/
            
          /*$('#select_file2').append($('<option>')
            .html(e[key]["files"][i].mimeType == "folder" ? "[Folder]" + e[key]["files"][i].name : e[key]["files"][i].name)
            .val(e[key]["files"][i].id)*/
          );
        }
      }
      
      function importData2(e) {
        var key = Object.keys(e)[0];
        if (!alldata[key]) alldata[key] = e[key];
        if (e[key]["keyparent"]) {
          //$('#select_file').append($('<option>').html("./" + e[key]["keyname"]).val(key));
          //$('#select_file').append($('<option>').html("../").val(e[key]["keyparent"]));
          
          $('#select_file2').append($('<option>').html("./" + e[key]["keyname"]).val(key));
          $('#select_file2').append($('<option>').html("../").val(e[key]["keyparent"]));
        } else {
          //$('#select_file').append($('<option>').html("./" + e[key]["keyname"]).val(key));
          $('#select_file2').append($('<option>').html("./" + e[key]["keyname"]).val(key));
        }
        for (var i=0; i < e[key]["files"].length; i++) {
          /*$('#select_file').append($('<option>')
            .html(e[key]["files"][i].mimeType == "folder" ? "[Folder]" + e[key]["files"][i].name : e[key]["files"][i].name)
            .val(e[key]["files"][i].id)*/
            
          $('#select_file2').append($('<option>')
            .html(e[key]["files"][i].mimeType == "folder" ? "[Folder]" + e[key]["files"][i].name : e[key]["files"][i].name)
            .val(e[key]["files"][i].id)
          );
        }
      }
      /***************************************************************************
      $(function() {
        google.script.run.withSuccessHandler(importData).getFiles("root");
        
        $('#select_file2').change(function() {
           var id2 = $('#select_file2').val();
           var disp2 = $('#select_file2 option:selected').text();
           if (~disp2.indexOf("Folder") || ~disp2.indexOf("../")) {
             $('#select_file2 > option').remove();
             if (alldata2[id2]) {
               var dat2 = {};
               dat2[id2] = alldata2[id2];
               importData(dat2);
               return;
             } else {
               google.script.run.withSuccessHandler(importData).getFiles(id2);
            
               return;
             }
             return;
           }
        });
       });
      
      function importData2(e) {
        var key2 = Object.keys(e)[1];
        if (!alldata2[key2]) alldata2[key2] = e[key2];
        if (e[key2]["keyparent"]) {
          $('#select_file2').append($('<option>').html("./" + e[key2]["keyname"]).val(key2));
          $('#select_file2').append($('<option>').html("../").val(e[key2]["keyparent"]));
        } else {
          $('#select_file2').append($('<option>').html("./" + e[key2]["keyname"]).val(key2));
        }
        for (var i=0; i < e[key2]["files"].length; i++) {
          $('#select_file2').append($('<option>')
            .html(e[key2]["files"][i].mimeType == "folder" ? "[Folder]" + e[key2]["files"][i].name : e[key2]["files"][i].name)
            .val(e[key2]["files"][i].id2)
          );
        }
      }*/
      /*******************************************************************************/
      
      function openDoc(){
        $("#success").remove();
        this.disabled = true;
        $('#error').remove();
        
        var style = $('#select_style').val();
        /*var id = $('#select_file').val();
        var id2 = $('#select_file2').val();*/
        //var id = '1klWk8P4l275FA2tUQcd9805rIPJKc4Tv';
        var docsBib = [];
        
        var files = document.getElementsByName("select_file[]"), i;
        for(i=0; i<files.length; i++){
          docsBib[i] = files[i].value;
        }
        //var id2 = idS[0];
        //var filesBib = document.getElementByName("files[]");
        //var filesBib = $("#select_file").multiSelect({});
        //var filesBib = $_POST['files'];
        
        var option = 1; //Opcion 1 = Citar y añadir la sección de referencias
        var filtros = [];
        
        /*for (i=0; i<files.length; i++){
          filesBib[i]=files[i];
        }*/
        
        filtros[0] = document.getElementById("filtroTipo").value;
        filtros[1] = document.getElementById("filtroYear").value;
        filtros[2] = document.getElementById("filtroAuthor").value;
        filtros[3] = document.getElementById("filtroSeries").value;
        filtros[4] = document.getElementById("filtroEditoriales").value;
        
        /*alert(escape(filtros[0]));
        alert(escape(filtros[1]));
        alert(escape(filtros[2]));*/
        
        
        /*Para el filtro, varios input text, cada uno con un id (tipo de objeto, año, titulo... )*/
        
        //alert(escape(files[0]));
        //alert(escape(filesBib[0]));
        
    
        
        
        google.script.run
        .withSuccessHandler(
          //google.script.run.withSuccessHandler(function getBibtexAndDoc(id2, style));
          function(exitoBibtex, element) {
            if(exitoBibtex){
              var msg = "Comprueba el nuevo documento que se ha creado en tu Drive con nombre: New Document";
              showSuccess(msg, $('#button-bar'));
            }else{
              var msg = "Hubo algun error durante el proceso. Es posible que en tu .bib falte algún campo obligatorio en alguna entrada o no hayas añadido el \bibliography para insertar la sección References.";
              showError(msg, $('#button-bar'));
            }            
           
            element.disabled = false;  
            
        })
        .withFailureHandler(
          function(msg, element) {
          msg = "Hubo un problema durante el proceso.Comprueba que hayas seleccionado el documento correcto.";
          showError(msg, $('#button-bar'));
          element.disabled = false;
        })
        .withUserObject(this)
        .getBibtexAndDoc(docsBib,style,filtros, option);
        //.getBibtexAndDoc(id,id2,style,filtros, option);
        /****************************************
        google.script.run
        .withSuccessHandler(
          
          function(exitoBibtex, element) {
            if(exitoBibtex){
              var msg = "Comprueba el nuevo documento que se ha creado en tu Drive con nombre: New Document";
              showSuccess(msg, $('#button-bar'));
            }else{
              var msg = "Hubo algun error durante el proceso. Es posible que en tu .bib falte algún campo obligatorio en alguna entrada o no hayas añadido el \bibliography para insertar la sección References.";
              showError(msg, $('#button-bar'));
            }            
           
            element.disabled = false;            
        })
        .withFailureHandler(
          function(msg, element) {
          msg = "Hubo un problema durante el proceso.Comprueba que hayas seleccionado el documento correcto.";
          showError(msg, $('#button-bar'));
          element.disabled = false;
        })
        .withUserObject(this)
        .getBibtexAndDoc(id2,style);
        *************************************************/
        
      }
      
      /********************************/
      function openDocReport(){
        $("#success").remove();
        this.disabled = true;
        $('#error').remove();
        
        var style = $('#select_style').val();
        /*var id = $('#select_file').val();
        var id2 = $('#select_file2').val();*/
        
        var docsBib = [];
        
        var files = document.getElementsByName("select_file[]"), i;
        for(i=0; i<files.length; i++){
          docsBib[i] = files[i].value;
        }
        var option = 2; //Opción 2 = Mostrar un reporte
        var filtros = [];
        
        filtros[0] = document.getElementById("filtroTipo").value;
        filtros[1] = document.getElementById("filtroYear").value;
        filtros[2] = document.getElementById("filtroAuthor").value;
        filtros[3] = document.getElementById("filtroSeries").value;
        filtros[4] = document.getElementById("filtroEditoriales").value;
        
        /*alert(escape(filtros[0]));
        alert(escape(filtros[1]));
        alert(escape(filtros[2]));*/
        
        
        /*Para el filtro, varios input text, cada uno con un id (tipo de objeto, año, titulo... )*/
        
        //alert(escape(filtro));
        
        /*google.script.run
        .withSuccessHandler(nameDoc)
        .withUserObject(this)
        .nombreDocumento();*/
        
        
        
        google.script.run
        .withSuccessHandler(
          //google.script.run.withSuccessHandler(function getBibtexAndDoc(id2, style));
          function(exitoBibtex, element) {
            if(exitoBibtex){
              //var doc = document.title();
              //var nombre = doc.getName();
              //alert(doc);
              var test = "si";
              var msg = "Comprueba el nuevo documento que se ha creado en tu Drive con nombre: 'Nombre actual'-Report";
              showSuccess(msg, $('#button-bar'));
            }else{
              var msg = "Hubo algun error durante el proceso. Es posible que en tu .bib falte algún campo obligatorio en alguna entrada o no hayas añadido el \bibliography para insertar la sección References.";
              showError(msg, $('#button-bar'));
            }            
           
            element.disabled = false;  
            
        })
        .withFailureHandler(
          function(msg, element) {
          msg = "Hubo un problema durante el proceso.Comprueba que hayas seleccionado el documento correcto.";
          showError(msg, $('#button-bar'));
          element.disabled = false;
        })
        .withUserObject(this)
        .getBibtexAndDoc(/*id,id2,*/docsBib,style,filtros,option);
        
      } 
      
      function nombreDocumento(name){
        alert(name);
      }
      
      /***********************************/
        
      function resetValues() {
        document.getElementById("id").innerHTML = "";
        document.getElementById("tittle").innerHTML = "";
      }
      
      /*function menuInfo() {
        //alert(escape("MENU"));
        var info = HtmlService.createHtmlOutputFromFile('Info').setTitle('Información');
        //DocumentApp.getUi().showModalDialog(info, 'AAAAA');

        google.script.run
        .withSuccessHandler(
          
        )
        .withUserObject(this)
        .showInfo(info)
        

      }*/
      
      /*function runCombination() {
        this.disabled = true;
        $('#error').remove();
        google.script.run
            .withSuccessHandler(
              function(msg, element) {
              
                               
                 openDoc();
                 
                 element.disabled = false;  
                               
              })
            .withFailureHandler(
              function(msg, element) {
                showError(msg, $('#button-bar'));
                element.disabled = false;
              })
            .withUserObject(this)
            .getText();
      }*/
      
      function showError(msg, element) {
        var div = $('<div id="error" class="error">' + msg + '</div>');
        $(element).after(div);
      }
      
      function showSuccess(msg, element) {
        var div = $('<div id="success" class="success">' + msg + '</div>');
        $(element).after(div);
      }
      
      $(document).ready(function () {
        $('.group').hide();
        $('#option1').show();
        $('#selectMe').change(function () {
          $('.group').hide();
          $('#'+$(this).val()).show();
        })
      });
      

    </script>
    
  </body>
</html>


